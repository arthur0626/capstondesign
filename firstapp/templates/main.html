{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>주류 마케팅 이미지 생성기</title>
    <link rel="stylesheet" href="{% static 'firstapp/css/style.css' %}">
</head>
<body>
    
    <div class="container">
        <aside class="sidebar" id="sidebar">
            <nav class="sidebar-nav">
                <button class="sidebar-menu-item">이미지 생성하기</button>
                <button class="sidebar-menu-item">내 기록</button>
                <button class="sidebar-menu-item">로그아웃</button>
            </nav>
        </aside>
        <div class="main-content" id="mainContent">
            <button class="sidebar-toggle-btn" id="sidebarToggleBtn">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </button>

            <div class="content-area" id="contentArea">
                
                {% if not image_urls %}
                <!-- Upload Section -->
                <div class="upload-section active" id="uploadSection">
                    <input type="file" id="imageUploadInput" accept="image/*" hidden>
                    <button class="upload-button" id="triggerImageUpload">
                        이미지 첨부
                    </button>
                    <p class="file-name" id="uploadedFileName"></p>
                    <p class="upload-info">* 이미지를 첨부해주세요</p>
                </div>
                <form method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                    <div class="options-section" id="optionsSection">
                        <!-- Left image panel -->
                        <div class="left-image-panel">
                            <div class="image-preview-after has-image" id="imagePreviewAfter"></div>
                            <input type="file" id="imageUploadInputAfter" accept="image/*" hidden>
                            <button class="upload-button-small" id="triggerImageUploadAfter">
                                이미지 첨부
                            </button>
                            <p class="file-name-after" id="uploadedFileNameAfter"></p>
                        </div>
                    
                        <div class="center-options-panel">

                            <div class="option-box">
                                <h3>테마 선택</h3>
                                <select name="theme" required>
                                    <option value="해변">해변</option>
                                    <option value="바">바</option>
                                    <option value="집">집</option>
                                    <option value="포장마차">포장마차</option>
                                    <option value="식당">식당</option>
                                </select>
                            </div>

                            <div class="option-box">
                                <h3>분위기 선택</h3>
                                <select name="mood" required>
                                    <option value="따듯한">따듯한</option>
                                    <option value="차가운">차가운</option>
                                    <option value="신나는">신나는</option>
                                    <option value="세련된">세련된</option>
                                    <option value="아련한">아련한</option>
                                </select>
                            </div>

                            <div class="option-box">
                                <h3>위치 설정</h3>
                                <select name="placement" required>
                                    <option value="테이블 위에 놓인">테이블 위</option>
                                    <option value="사람이 들고 있는">사람 손</option>
                                    <option value="바에 진열되어 있는는">바에 진열</option>
                                </select>
                            </div>

                            <div class="option-box">
                                <h3>비율 설정</h3>
                                <select name="aspect_ratio" required>
                                    <option value="1:1">1:1</option>
                                    <option value="3:4">3:4</option>
                                    <option value="4:3">4:3</option>
                                    <option value="9:16">9:16</option>
                                    <option value="16:9" selected>16:9</option>
                                </select>
                            </div>

                            <div class="option-box">
                                <h3>생성 이미지 수량 (1~10)</h3>
                                <input type="number" name="count" min="1" max="10" value="4" required>
                            </div>
                            
                            <div class="additional-requirements option-box">
                                <h3>추가 사용자 프롬프트</h3>
                                <div id="additionalReqFields"></div>
                                <div class="add-req-btn-wrapper">
                                    <button type="button" class="add-req-btn" id="addRequirementBtn">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="right-generate-button-panel">
                            <button type="submit" class="generate-button">이미지 생성</button>
                        </div>                 
                    </div>
                </form>
                {% endif %}
                {% if image_urls %}
                <div class="results-container">
                    <div class="image-grid">
                        {% for url in image_urls %}
                            <div class="image-item">
                                <img src="{%static url %}" alt="생성 이미지" width="300" length="300">
                            </div>
                            <a href="{{ url }}" download><button>이미지 다운로드</button></a>
                        {% endfor %}
                    </div>          

                    <div class="recommend-texts">
                        <h2>추천 문구 ({{ word_urls|length }}개)</h2>
                        {% for sentence in word_urls %}
                            <p> {{ sentence }}</p>
                        {% endfor %}
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <form method="get">
                            <button type="submit" class="generate-button">다시 생성하기</button>
                        </form>
                    </div>
                </div>
                {% endif %}
                
            </div>
        </div>
    </div>
    <script src="{% static 'firstapp/js/script.js' %}"></script>
</body>
</html>