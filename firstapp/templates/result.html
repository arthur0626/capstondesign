{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/result.css' %}">
{% endblock %}

{% block title %}ìƒì„± ê²°ê³¼ - My Project{% endblock %}

{% block content %}
<div class="results-container">
    <div class="results-card">
        <h2>ì´ë¯¸ì§€ ìƒì„± ê²°ê³¼</h2>
        
        <div class="content-wrapper">
            <div class="gallery-column">
                <div class="main-image-wrapper">
                    <img src="{{ image_urls.0 }}" id="main-image" alt="ìƒì„±ëœ ë©”ì¸ ì´ë¯¸ì§€">
                    <a href="{{ image_urls.0 }}" 
                        download="generated_image_1.png" 
                        id="download-link" 
                        class="download-btn" 
                        title="í˜„ì¬ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ">
                        <span>â†“</span>
                    </a>
                </div>
                <div class="thumbnail-wrapper" id="thumbnail-container">
                    {% for url in image_urls %}
                        <img src="{{ url }}" class="thumbnail {% if forloop.first %}active{% endif %}" alt="ì¸ë„¤ì¼ {{ forloop.counter }}" data-src="{{ url }}">
                    {% endfor %}
                </div>    
            </div>

            <div class="recommend-column">
                <h3>ì¶”ì²œ ë¬¸êµ¬</h3>
                <div class="recommend-list">
                    {% if word_urls %}
                        {% for sentence in word_urls %}
                            <p>{{ sentence }}</p>
                        {% endfor %}
                    {% else %}
                        <p>ì¶”ì²œ ë¬¸êµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="action-btn" title="íˆìŠ¤í† ë¦¬ (ì¤€ë¹„ ì¤‘)" disabled>
                <span class="icon-gallery">ğŸ–¼ï¸</span>
            </button>

            <a href="{% url 'main' %}?product_type={{ original_settings.product_type|urlencode }}&theme={{ original_settings.theme|urlencode }}&mood={{ original_settings.mood|urlencode }}&placement={{ original_settings.placement|urlencode }}&prompt={{ original_settings.prompt|urlencode }}&extra_requirements={{ original_settings.extra_requirements|urlencode }}&model={{ original_settings.model|urlencode }}&aspect_ratio={{ original_settings.aspect_ratio|urlencode }}&count={{ original_settings.count|urlencode }}" 
               class="action-btn" 
               title="ì„¤ì • ìœ ì§€í•˜ê³  ëŒì•„ê°€ê¸°">
                <span class="icon-undo">ğŸ”„</span>
            </a>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const mainImage = document.getElementById('main-image');
    const downloadLink = document.getElementById('download-link');
    const thumbnailContainer = document.getElementById('thumbnail-container');
    const thumbnails = thumbnailContainer.querySelectorAll('.thumbnail');

    thumbnailContainer.addEventListener('click', (e) => {
        // ì¸ë„¤ì¼ ì´ë¯¸ì§€ í´ë¦­ ì‹œ
        if (e.target.classList.contains('thumbnail')) {
            const newSrc = e.target.dataset.src;
            
            // 1. í° ì´ë¯¸ì§€ ë³€ê²½
            mainImage.src = newSrc;
            
            // 2. ë‹¤ìš´ë¡œë“œ ë§í¬ ë³€ê²½
            downloadLink.href = newSrc;
            
            // 3. (ì„ íƒ) í™œì„± ì¸ë„¤ì¼ ìŠ¤íƒ€ì¼ ë³€ê²½
            thumbnails.forEach(thumb => thumb.classList.remove('active'));
            e.target.classList.add('active');
        }
    });
});
</script>
{% endblock %}